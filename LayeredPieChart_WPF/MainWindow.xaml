<Window x:Class="LayeredPieChart_WPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:LayeredPieChart_WPF"
        xmlns:chart="http://schemas.syncfusion.com/wpf"
        xmlns:diagram="clr-namespace:Syncfusion.UI.Xaml.Diagram;assembly=Syncfusion.SfDiagram.WPF"
        xmlns:Syncfusion="http://schemas.syncfusion.com/wpf"
        mc:Ignorable="d"
        Title="MainWindow" Height="450" Width="800">

    <Window.Resources>
        <ResourceDictionary>
            <!--DataTemplate for Content of Node-->
            <DataTemplate x:Key="ContentTemplateforNode">
                <Border Width="110" Height="40" BorderThickness="1" Background="{Binding Path=NodeColor}" 
                CornerRadius="6" BorderBrush="#5e5e5e">
                    <TextBlock Text="{Binding Path=NodeName}" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Border>
            </DataTemplate>

            <!--Style for Node-->
            <Style TargetType="Syncfusion:Node">
                <Setter Property="ContentTemplate" Value="{StaticResource ContentTemplateforNode}"/>
            </Style>

            <!--Style for Connector-->
            <Style TargetType="Syncfusion:Connector">
                <Setter Property="ConnectorGeometryStyle">
                    <Setter.Value>
                        <Style TargetType="Path">
                            <Setter Property="Stroke" Value="Black"  />
                            <Setter Property="StrokeThickness" Value="1" />
                        </Style>
                    </Setter.Value>
                </Setter>
                <Setter Property="TargetDecorator" Value="M0,0 L10,5 L0,10 L 0,0"></Setter>
                <Setter Property="TargetDecoratorStyle">
                    <Setter.Value>
                        <Style TargetType="Path">
                            <Setter Property="Stretch" Value="Fill"></Setter>
                            <Setter Property="Width" Value="7.5"></Setter>
                            <Setter Property="Height" Value="7.5"></Setter>
                            <Setter Property="Stroke" Value="Black"/>
                            <Setter Property="Fill" Value="Black"/>
                        </Style>
                    </Setter.Value>
                </Setter>
                <Setter Property="CornerRadius" Value="10"/>
            </Style>

        </ResourceDictionary>
    </Window.Resources>

    <Border Margin="30" Padding="5" BorderThickness="3" CornerRadius="10"  BorderBrush="#7f3541" Background="#fbf4f6">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="6*"/>
                <ColumnDefinition Width="4*"/>
            </Grid.ColumnDefinitions>

            <Grid.RowDefinitions>
                <RowDefinition Height="2*"/>
                <RowDefinition Height="8*"/>
            </Grid.RowDefinitions>

            <chart:SfChart x:Name="chart" Grid.Column="0" Grid.RowSpan="2" 
                           SelectionChanged="SfChart_SelectionChanged">

                <chart:SfChart.DataContext>
                    <local:VitaminFoodViewModel/>
                </chart:SfChart.DataContext>

                <chart:SfChart.Header>
                    <Grid Margin="0,3,20,40">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Orientation="Vertical" Margin="0,10,5,0" Background="#684980" Width="10"/>
                        <StackPanel Grid.Column="1">
                            <TextBlock Text="What’s Really in Your Food? A Visual Guide to Vitamins and Caloric Impact" FontSize="24" FontWeight="Bold" Foreground="Black"/>
                            <TextBlock Text="Understanding Vitamins, Their Food Sources, and Caloric Values Through Engaging Visual Data Representations" FontSize="16" Foreground="Gray"/>
                        </StackPanel>
                    </Grid>
                </chart:SfChart.Header>

                <chart:SfChart.Resources>
                    <DataTemplate x:Key="VitaminLabelTemplate">
                        <TextBlock Text="{Binding Item.Name}" FontWeight="Bold" Foreground="White" FontFamily="Century Gothic"/>
                    </DataTemplate>

                    <DataTemplate x:Key="FoodLabelTemplate">
                        <TextBlock Text="{Binding Item.Source}" FontWeight="Bold" Foreground="White" FontFamily="Century Gothic"/>
                    </DataTemplate>
                </chart:SfChart.Resources>

                <chart:PieSeries x:Name="pieSeries1"              
                                 ItemsSource="{Binding Vitamins}" 
                                 XBindingPath="Name" 
                                 YBindingPath="Value" 
                                 Stroke="White"                                
                                 StrokeThickness="2"
                                 PieCoefficient="1" 
                                 EnableSmartLabels="True"
                                 SegmentColorPath="Color">

                    <chart:PieSeries.AdornmentsInfo>
                        <chart:ChartAdornmentInfo SegmentLabelContent="LabelContentPath" LabelTemplate="{StaticResource VitaminLabelTemplate}"
                                                  ShowLabel="True" />
                    </chart:PieSeries.AdornmentsInfo>
                </chart:PieSeries>

                <chart:PieSeries x:Name="pieSeries2"                 
                                 ItemsSource="{Binding FoodSources}" 
                                 XBindingPath="Source" 
                                 YBindingPath="Value" 
                                 Stroke="White" 
                                 StrokeThickness="2"
                                 EnableSmartLabels="True" 
                                 ShowTooltip="False" 
                                 SegmentColorPath="Color">

                    <chart:PieSeries.AdornmentsInfo>
                        <chart:ChartAdornmentInfo SegmentLabelContent="LabelContentPath" LabelTemplate="{StaticResource FoodLabelTemplate}"  
                                                  ShowLabel="True" />
                    </chart:PieSeries.AdornmentsInfo>
                </chart:PieSeries>

                <chart:SfChart.Behaviors>
                    <chart:ChartSelectionBehavior SelectionStyle="Single"     
                                                  SelectionMode="MouseClick" 
                                                  EnableSegmentSelection="True"
                                                  EnableSeriesSelection="False">
                    </chart:ChartSelectionBehavior>
                </chart:SfChart.Behaviors>
            </chart:SfChart>

            <!--Initialize Diagram-->
            <Syncfusion:SfDiagram x:Name="diagram"
                                  Grid.Column="1"
                                  Grid.Row="1"
                                  HorizontalAlignment="Stretch"
                                  VerticalAlignment="Stretch"
                                  DefaultConnectorType="CubicBezier"
                                  Nodes="{Binding Nodes}"
                                  Connectors="{Binding Connectors}"
                                  Constraints="{Binding Constraints}"
                                  Tool="{Binding Tool}"
                                  Menu="{Binding Menu}"
                                  HorizontalRuler="{Binding HorizontalRuler}"
                                  VerticalRuler="{Binding VerticalRuler}"
                                  DataSourceSettings="{Binding DataSourceSettings}"
                                  LayoutManager="{Binding LayoutManager}">


                <Syncfusion:SfDiagram.DataContext>
                    <local:MultiParent x:Name="multiParent"/>
                </Syncfusion:SfDiagram.DataContext>

                <Syncfusion:SfDiagram.PageSettings>
                    <Syncfusion:PageSettings PageBackground="#fbf4f6"/>
                </Syncfusion:SfDiagram.PageSettings>
            </Syncfusion:SfDiagram>
        </Grid>
    </Border>
</Window>
